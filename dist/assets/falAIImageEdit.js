const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index2.js","./index.js"])))=>i.map(i=>d[i]);
import{d as re,r as i,c as d,a as o,b as l,e as h,w as a,f as pe,t as f,F as S,g as A,h as y,o as u,i as me,j as s,_ as ve}from"./index.js";const fe={class:"fal-ai-image-edit"},ge={class:"apikey-section"},be={key:0,class:"tip"},ye={key:1,class:"tip"},ce={key:0,style:{"margin-top":"12px"}},xe={style:{display:"flex",gap:"8px","flex-wrap":"wrap"}},_e=["src","onClick"],he={style:{position:"absolute",top:"2px",left:"2px",background:"rgba(0,0,0,0.7)",color:"white",padding:"2px 4px","border-radius":"2px","font-size":"10px"}},we={key:0,style:{color:"red","margin-top":"16px"}},ke={key:1,style:{"margin-top":"16px"}},Ve={key:2,style:{"margin-top":"24px"}},Pe={style:{display:"flex","flex-wrap":"wrap",gap:"16px"}},Ie=["src","alt","width","height","onClick"],ze={style:{"font-size":"12px",color:"#888"}},Ue={key:3,style:{"margin-top":"40px"}},Ce={style:{"font-size":"13px",color:"#888","margin-bottom":"6px"}},Re={style:{"margin-bottom":"6px"}},Se={style:{color:"#333"}},Ae={style:{"margin-bottom":"6px"}},Ee={key:0},Ke={style:{display:"flex","flex-wrap":"wrap",gap:"12px"}},Ne=["src","alt","width","height","onClick"],Oe={style:{"font-size":"11px",color:"#aaa"}},je={style:{"text-align":"center"}},$e=["src"],Fe={key:1,style:{"margin-top":"16px",color:"#666"}},De={style:{"text-align":"center"}},Le=["src"],Me=`[Base Rules]
- Keep the exact bottle shape, size, proportions, pump/nozzle position, and structure unchanged.
- Keep the bottle's material, thickness, and transparency the same unless explicitly requested to change.
- Preserve all original physical dimensions of the bottle.
- Only apply design elements such as patterns, textures, colors, or labels on the bottle surface.
- Replace or enhance the background according to the user request, but ensure the bottle remains the main subject.
- Avoid adding any human hands, faces, or unrelated objects unless explicitly requested.
- Maintain realistic lighting, shading, and natural reflections on the bottle.
- Ensure that all design changes appear naturally integrated with the original product photograph.
- Maintain professional quality of high-end skincare product packaging still life photography.
Note: Please apply all visual updates based on the product information while preserving the bottle`,Be=re({__name:"falAIImageEdit",setup(F){let w=null;const k=i("ce76ded4-4b39-42d3-86d8-b3920fb41b9b:ae0c075f6e887f0239930282f3f1ed4a"),r=i(null);async function D(){w||(w=(await ve(async()=>{const{fal:m}=await import("./index2.js").then(e=>e.i);return{fal:m}},__vite__mapDeps([0,1]),import.meta.url)).fal)}function le(){k.value&&(r.value=k.value)}function te(){k.value="",r.value=null}const C=i(""),E=i("");i(null);const V=i([]),K=i(null),L=i(3.5),M=i(1),B=i("jpeg"),J=i("2"),N=i(""),q=i(!1),G=i(!0),P=i(!1),c=i([]),x=i(""),O=i([]),T=i([]),j=i(!1),U=i(null),Q=i(null),$=i(!1);function ae(m){if(m.raw){const e=new FileReader;e.onload=I=>{var p;V.value.push({url:(p=I.target)==null?void 0:p.result,name:m.name})},e.readAsDataURL(m.raw)}}function oe(m){V.value=V.value.filter(e=>e.name!==m.name)}function se(m){Q.value=m,$.value=!0}function ne(){$.value=!1}function X(m){U.value=m,j.value=!0}function ie(){j.value=!1,U.value=null}async function ue(){if(x.value="",c.value=[],O.value=[],!C.value.trim()){x.value="请输入描述（Prompt）";return}if(P.value=!0,await D(),!w){x.value="fal-ai 客户端加载失败",P.value=!1;return}if(!r.value){x.value="请先输入 API Key",P.value=!1;return}w.config({credentials:r.value});let m=[];try{if(V.value.length===0){x.value="请至少选择一张图片",P.value=!1;return}for(let n=0;n<V.value.length;n++){const g=V.value[n];if(g.url.startsWith("data:")){c.value.push(`正在上传图片 ${n+1}...`);const b=await(await fetch(g.url)).blob(),W=new File([b],g.name,{type:b.type}),R=await w.storage.upload(W);m.push(R),c.value.push(`图片 ${n+1} 上传成功`)}else m.push(g.url),c.value.push(`使用图片 ${n+1} URL: ${g.url}`)}if(E.value&&E.value.split(",").forEach(n=>{n.trim()&&m.push(n.trim())}),m.length===0){x.value="没有有效的图片URL或文件可供生成",P.value=!1;return}c.value.push("正在请求 fal.ai 生成图片...");const I={prompt:G.value?`${C.value}

${Me}`:C.value,image_urls:m,guidance_scale:L.value,num_images:M.value,output_format:B.value,safety_tolerance:J.value,sync_mode:q.value,...N.value?{aspect_ratio:N.value}:{},...K.value?{seed:K.value}:{}},p=await w.subscribe("fal-ai/flux-pro/kontext/max/multi",{input:I,logs:!0,onQueueUpdate:n=>{n.status==="IN_PROGRESS"&&n.logs&&n.logs.map(g=>g.message).forEach(g=>{c.value.includes(g)||c.value.push(g)})}});p.data&&p.data.images?(O.value=p.data.images,c.value.push("图片生成成功"),T.value.unshift({params:JSON.parse(JSON.stringify(I)),images:JSON.parse(JSON.stringify(p.data.images)),time:new Date().toLocaleString()})):x.value="未获取到图片结果"}catch(e){x.value=(e==null?void 0:e.message)||"请求失败"}finally{P.value=!1}}return(m,e)=>{const I=y("el-input"),p=y("el-form-item"),n=y("el-button"),g=y("el-form"),Y=y("el-checkbox"),b=y("el-tooltip"),W=y("el-upload"),R=y("el-input-number"),v=y("el-option"),H=y("el-select"),de=y("el-switch"),Z=y("el-dialog");return u(),d("div",fe,[e[36]||(e[36]=o("h2",null,"fal.ai 图像编辑 DEMO",-1)),o("div",ge,[l(g,{inline:!0,class:"apikey-form"},{default:a(()=>[l(p,{label:"API Key："},{default:a(()=>[l(I,{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=t=>k.value=t),type:"password",placeholder:"请输入 fal.ai API Key",style:{width:"260px"}},null,8,["modelValue"])]),_:1}),l(p,null,{default:a(()=>[l(n,{type:"primary",onClick:le},{default:a(()=>e[13]||(e[13]=[s("保存")])),_:1}),r.value?(u(),me(n,{key:0,onClick:te,type:"default"},{default:a(()=>e[14]||(e[14]=[s("清除")])),_:1})):h("",!0)]),_:1})]),_:1}),r.value?(u(),d("div",ye,e[16]||(e[16]=[o("span",{style:{color:"green"}},"API Key 已保存，可正常使用 fal.ai 能力。",-1)]))):(u(),d("div",be,e[15]||(e[15]=[o("span",{style:{color:"red"}},"请先输入 API Key，所有功能仅用于 DEMO，切勿用于生产环境！",-1)])))]),l(g,{class:"falai-form",onSubmit:pe(ue,["prevent"]),"label-width":"140px"},{default:a(()=>[l(p,{label:"固定提示词："},{default:a(()=>[e[18]||(e[18]=o("div",{style:{background:"#f5f7fa",padding:"12px","border-radius":"6px",border:"1px solid #e4e7ed","margin-bottom":"8px"}},[s("  "),o("div",{style:{"font-size":"14px",color:"#606266","line-height":"1.6"}},[s("             "),o("strong",null,"基础规则："),o("br"),s("             • 保持瓶子的确切形状、大小、比例、泵头/喷嘴位置和结构不变"),o("br"),s("             • 保持瓶子的材质、厚度和透明度不变（除非明确要求改变）"),o("br"),s("             • 保持瓶子的所有原始物理尺寸"),o("br"),s("             • 仅在瓶子表面应用设计元素（图案、纹理、颜色或标签）"),o("br"),s("             • 根据用户要求替换或增强背景，但确保瓶子仍是主体"),o("br"),s("             • 避免添加人手、面部或不相关物体（除非明确要求）"),o("br"),s("             • 保持逼真的光照、阴影和自然反射"),o("br"),s("             • 确保所有设计变化与原始产品照片自然融合"),o("br"),s("             • 保持高端护肤产品包装静物摄影的专业品质"),o("br"),s("           注意：请根据产品信息应用所有视觉更新，同时保持瓶子的完整性。 ")])],-1)),l(Y,{modelValue:G.value,"onUpdate:modelValue":e[1]||(e[1]=t=>G.value=t),disabled:!r.value},{default:a(()=>e[17]||(e[17]=[s("使用固定提示词")])),_:1},8,["modelValue","disabled"])]),_:1}),l(p,{label:"描述（Prompt）："},{default:a(()=>[l(I,{modelValue:C.value,"onUpdate:modelValue":e[2]||(e[2]=t=>C.value=t),type:"textarea",autosize:{minRows:4,maxRows:8},disabled:!r.value,placeholder:"请输入描述，如：在面粉旁边放一个甜甜圈。",style:{width:"100%","font-size":"16px"}},null,8,["modelValue","disabled"]),l(b,{content:"用于生成图像的提示词",placement:"top"},{default:a(()=>[l(n,{type:"text",size:"small",style:{padding:"0","margin-left":"8px"}},{default:a(()=>e[19]||(e[19]=[s("参数说明")])),_:1})]),_:1})]),_:1}),l(p,{label:"图片："},{default:a(()=>[e[23]||(e[23]=o("div",{style:{background:"#fff7ed",padding:"8px","border-radius":"4px","border-left":"3px solid #f97316","margin-bottom":"8px"}},[o("div",{style:{"font-size":"12px",color:"#c2410c"}},[o("strong",null,"重要提示："),s("第一张图片是主要对象，其他图片作为参考。AI会按照上传顺序处理图片。 ")])],-1)),l(W,{"show-file-list":!0,disabled:!r.value,accept:"image/*",action:"#","auto-upload":!1,"on-change":ae,"on-remove":oe,limit:5,multiple:""},{default:a(()=>[l(n,{disabled:!r.value},{default:a(()=>e[20]||(e[20]=[s("选择图片")])),_:1},8,["disabled"])]),_:1},8,["disabled"]),e[24]||(e[24]=o("span",{style:{margin:"0 8px"}},"或",-1)),l(I,{modelValue:E.value,"onUpdate:modelValue":e[3]||(e[3]=t=>E.value=t),disabled:!r.value,placeholder:"图片 URL（可选，多个用逗号分隔）",style:{width:"260px"}},null,8,["modelValue","disabled"]),V.value.length?(u(),d("div",ce,[e[21]||(e[21]=o("div",{style:{"font-size":"12px",color:"#666","margin-bottom":"4px"}},"选择的图片：",-1)),o("div",xe,[(u(!0),d(S,null,A(V.value,(t,_)=>(u(),d("div",{key:_,style:{border:"1px solid #e4e7ed","border-radius":"4px",padding:"4px",background:"#fff",position:"relative"}},[o("img",{src:t.url,alt:"selected-image",style:{"max-width":"120px","max-height":"80px",display:"block",cursor:"pointer","object-fit":"contain"},onClick:z=>se(t.url)},null,8,_e),o("div",he,f(_+1),1)]))),128))])])):h("",!0),l(b,{content:"用于 omnimodel 的图像提示，第一张图片为主要对象",placement:"top"},{default:a(()=>[l(n,{type:"text",size:"small",style:{padding:"0","margin-left":"8px"}},{default:a(()=>e[22]||(e[22]=[s("参数说明")])),_:1})]),_:1})]),_:1}),l(p,{label:"种子值（Seed）："},{default:a(()=>[l(R,{modelValue:K.value,"onUpdate:modelValue":e[4]||(e[4]=t=>K.value=t),disabled:!r.value,min:1,max:999999,style:{width:"120px"}},null,8,["modelValue","disabled"]),l(b,{content:"相同的种子值和提示词给定给相同版本的模型将每次都输出相同的图像",placement:"top"},{default:a(()=>[l(n,{type:"text",size:"small",style:{padding:"0","margin-left":"8px"}},{default:a(()=>e[25]||(e[25]=[s("参数说明")])),_:1})]),_:1})]),_:1}),l(p,{label:"引导强度："},{default:a(()=>[l(R,{modelValue:L.value,"onUpdate:modelValue":e[5]||(e[5]=t=>L.value=t),min:1,max:20,step:.1,disabled:!r.value},null,8,["modelValue","disabled"]),l(b,{content:"CFG（无分类器引导）比例是衡量您希望模型在寻找相关图像时对提示词的遵循程度。默认值：3.5",placement:"top"},{default:a(()=>[l(n,{type:"text",size:"small",style:{padding:"0","margin-left":"8px"}},{default:a(()=>e[26]||(e[26]=[s("参数说明")])),_:1})]),_:1})]),_:1}),l(p,{label:"生成图片数量："},{default:a(()=>[l(R,{modelValue:M.value,"onUpdate:modelValue":e[6]||(e[6]=t=>M.value=t),min:1,max:6,disabled:!r.value},null,8,["modelValue","disabled"]),l(b,{content:"要生成的图像数量。默认值：1",placement:"top"},{default:a(()=>[l(n,{type:"text",size:"small",style:{padding:"0","margin-left":"8px"}},{default:a(()=>e[27]||(e[27]=[s("参数说明")])),_:1})]),_:1})]),_:1}),l(p,{label:"输出格式："},{default:a(()=>[l(H,{modelValue:B.value,"onUpdate:modelValue":e[7]||(e[7]=t=>B.value=t),disabled:!r.value,style:{width:"120px"}},{default:a(()=>[l(v,{label:"JPEG 格式",value:"jpeg"}),l(v,{label:"PNG 格式",value:"png"})]),_:1},8,["modelValue","disabled"]),l(b,{content:"生成图像的格式。默认值：jpeg",placement:"top"},{default:a(()=>[l(n,{type:"text",size:"small",style:{padding:"0","margin-left":"8px"}},{default:a(()=>e[28]||(e[28]=[s("参数说明")])),_:1})]),_:1})]),_:1}),l(p,{label:"安全等级："},{default:a(()=>[l(H,{modelValue:J.value,"onUpdate:modelValue":e[8]||(e[8]=t=>J.value=t),disabled:!r.value,style:{width:"120px"}},{default:a(()=>[l(v,{label:"最严格",value:"1"}),l(v,{label:"严格",value:"2"}),l(v,{label:"中等",value:"3"}),l(v,{label:"宽松",value:"4"}),l(v,{label:"最宽松",value:"5"}),l(v,{label:"无限制",value:"6"})]),_:1},8,["modelValue","disabled"]),l(b,{content:"生成图像的安全容差级别，1最严格，6最宽松。默认值：2",placement:"top"},{default:a(()=>[l(n,{type:"text",size:"small",style:{padding:"0","margin-left":"8px"}},{default:a(()=>e[29]||(e[29]=[s("参数说明")])),_:1})]),_:1})]),_:1}),l(p,{label:"宽高比："},{default:a(()=>[l(H,{modelValue:N.value,"onUpdate:modelValue":e[9]||(e[9]=t=>N.value=t),disabled:!r.value,style:{width:"120px"}},{default:a(()=>[l(v,{label:"默认",value:""}),l(v,{label:"21:9",value:"21:9"}),l(v,{label:"16:9",value:"16:9"}),l(v,{label:"4:3",value:"4:3"}),l(v,{label:"3:2",value:"3:2"}),l(v,{label:"1:1",value:"1:1"}),l(v,{label:"2:3",value:"2:3"}),l(v,{label:"3:4",value:"3:4"}),l(v,{label:"9:16",value:"9:16"}),l(v,{label:"9:21",value:"9:21"})]),_:1},8,["modelValue","disabled"]),l(b,{content:"生成图像的宽高比",placement:"top"},{default:a(()=>[l(n,{type:"text",size:"small",style:{padding:"0","margin-left":"8px"}},{default:a(()=>e[30]||(e[30]=[s("参数说明")])),_:1})]),_:1})]),_:1}),l(p,{label:"同步模式："},{default:a(()=>[l(de,{modelValue:q.value,"onUpdate:modelValue":e[10]||(e[10]=t=>q.value=t),disabled:!r.value},null,8,["modelValue","disabled"]),l(b,{content:"如果设置为true，函数将等待图像生成并上传后再返回响应。默认值：false",placement:"top"},{default:a(()=>[l(n,{type:"text",size:"small",style:{padding:"0","margin-left":"8px"}},{default:a(()=>e[31]||(e[31]=[s("参数说明")])),_:1})]),_:1})]),_:1}),l(p,null,{default:a(()=>[l(n,{type:"primary","native-type":"submit",disabled:!r.value||P.value},{default:a(()=>[s(f(P.value?"生成中...":"生成图片"),1)]),_:1},8,["disabled"])]),_:1})]),_:1}),x.value?(u(),d("div",we,f(x.value),1)):h("",!0),c.value.length?(u(),d("div",ke,[e[32]||(e[32]=o("div",{style:{"font-weight":"bold"}},"日志：",-1)),o("ul",null,[(u(!0),d(S,null,A(c.value,(t,_)=>(u(),d("li",{key:_},f(t),1))),128))])])):h("",!0),O.value.length?(u(),d("div",Ve,[e[33]||(e[33]=o("div",{style:{"font-weight":"bold"}},"生成结果：",-1)),o("div",Pe,[(u(!0),d(S,null,A(O.value,(t,_)=>(u(),d("div",{key:_,style:{border:"1px solid #eee",padding:"8px","border-radius":"6px",background:"#fff"}},[o("img",{src:t.url,alt:"result-"+_,width:t.width/4,height:t.height/4,style:{"max-width":"200px",display:"block","margin-bottom":"8px",cursor:"pointer"},onClick:z=>X(t)},null,8,Ie),o("div",ze,f(t.width)+"x"+f(t.height),1)]))),128))])])):h("",!0),T.value.length?(u(),d("div",Ue,[e[35]||(e[35]=o("div",{style:{"font-weight":"bold","font-size":"16px"}},"历史记录",-1)),(u(!0),d(S,null,A(T.value,(t,_)=>(u(),d("div",{key:_,style:{"margin-top":"18px",padding:"12px",border:"1px solid #eee","border-radius":"6px",background:"#f8f8fa"}},[o("div",Ce,f(t.time),1),o("div",Re,[e[34]||(e[34]=s("Prompt: ")),o("span",Se,f(t.params.prompt),1)]),o("div",Ae,[s("引导强度: "+f(t.params.guidance_scale)+" | 数量: "+f(t.params.num_images)+" | 输出格式: "+f(t.params.output_format)+" ",1),t.params.aspect_ratio?(u(),d("span",Ee,"| 宽高比: "+f(t.params.aspect_ratio),1)):h("",!0)]),o("div",Ke,[(u(!0),d(S,null,A(t.images,(z,ee)=>(u(),d("div",{key:ee,style:{border:"1px solid #eee",padding:"4px","border-radius":"4px",background:"#fff"}},[o("img",{src:z.url,alt:"history-"+_+"-"+ee,width:z.width/8,height:z.height/8,style:{"max-width":"100px",display:"block",cursor:"pointer"},onClick:qe=>X(z)},null,8,Ne),o("div",Oe,f(z.width)+"x"+f(z.height),1)]))),128))])]))),128))])):h("",!0),l(Z,{modelValue:j.value,"onUpdate:modelValue":e[11]||(e[11]=t=>j.value=t),title:"图片预览",width:"80%","before-close":ie},{default:a(()=>[o("div",je,[U.value?(u(),d("img",{key:0,src:U.value.url,style:{"max-width":"100%","max-height":"70vh","object-fit":"contain"}},null,8,$e)):h("",!0),U.value?(u(),d("div",Fe," 尺寸: "+f(U.value.width)+" x "+f(U.value.height),1)):h("",!0)])]),_:1},8,["modelValue"]),l(Z,{modelValue:$.value,"onUpdate:modelValue":e[12]||(e[12]=t=>$.value=t),title:"选择图片预览",width:"80%","before-close":ne},{default:a(()=>[o("div",De,[Q.value?(u(),d("img",{key:0,src:Q.value,style:{"max-width":"100%","max-height":"70vh","object-fit":"contain"}},null,8,Le)):h("",!0)])]),_:1},8,["modelValue"])])}}}),Je=(F,w)=>{const k=F.__vccOpts||F;for(const[r,D]of w)k[r]=D;return k},Te=Je(Be,[["__scopeId","data-v-f41a275d"]]);export{Te as default};
