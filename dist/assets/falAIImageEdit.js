const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index2.js","./index.js"])))=>i.map(i=>d[i]);
import{d as ee,r as n,c as i,a,b as l,e as x,w as o,f as le,t as r,F as S,g as E,h as f,o as s,i as te,j as v,_ as ae}from"./index.js";const oe={class:"fal-ai-image-edit"},se={class:"apikey-section"},ue={key:0,class:"tip"},ie={key:1,class:"tip"},ne={key:0,style:{color:"red","margin-top":"16px"}},de={key:1,style:{"margin-top":"16px"}},re={key:2,style:{"margin-top":"24px"}},pe={style:{display:"flex","flex-wrap":"wrap",gap:"16px"}},ve=["src","alt","width","height","onClick"],me={style:{"font-size":"12px",color:"#888"}},fe={key:3,style:{"margin-top":"40px"}},ce={style:{"font-size":"13px",color:"#888","margin-bottom":"6px"}},be={style:{"margin-bottom":"6px"}},ye={style:{color:"#333"}},ge={style:{"margin-bottom":"6px"}},_e={key:0},xe={style:{display:"flex","flex-wrap":"wrap",gap:"12px"}},he=["src","alt","width","height","onClick"],we={style:{"font-size":"11px",color:"#aaa"}},ke={style:{"text-align":"center"}},Ve=["src"],Pe={key:1,style:{"margin-top":"16px",color:"#666"}},Ie=`Keep the exact same bottle shape, proportions, and pump head position.
Do not change the number, size, angle, position, or layout of the bottles — even if the image contains multiple bottles of different sizes.
The structure and placement of the bottles must remain completely unchanged.
Any added content should be naturally and cleanly integrated without disrupting or covering the original layout.
Note: Please apply all visual updates based on the product information while preserving the bottle`,Ue=ee({__name:"falAIImageEdit",setup(K){let g=null;const _=n(""),u=n(null);async function z(){g||(g=(await ae(async()=>{const{fal:m}=await import("./index2.js").then(e=>e.i);return{fal:m}},__vite__mapDeps([0,1]),import.meta.url)).fal)}function G(){_.value&&(u.value=_.value)}function Q(){_.value="",u.value=null}const U=n(""),O=n(""),R=n(null),D=n(3.5),F=n(1),J=n("jpeg"),C=n(""),L=n(!0),h=n(!1),c=n([]),b=n(""),A=n([]),j=n([]),N=n(!1),w=n(null);function q(m){R.value=m.raw||null}function B(m){w.value=m,N.value=!0}function H(){N.value=!1,w.value=null}async function W(){if(b.value="",c.value=[],A.value=[],!U.value.trim()){b.value="请输入描述（Prompt）";return}if(h.value=!0,await z(),!g){b.value="fal-ai 客户端加载失败",h.value=!1;return}if(!u.value){b.value="请先输入 API Key",h.value=!1;return}g.config({credentials:u.value});let m=O.value;try{if(R.value&&(c.value.push("正在上传图片..."),m=await g.storage.upload(R.value),c.value.push("图片上传成功")),!m){b.value="请上传图片或填写图片 URL",h.value=!1;return}c.value.push("正在请求 fal.ai 生成图片...");const I={prompt:L.value?`${Ie}

${U.value}`:U.value,image_url:m,guidance_scale:D.value,num_images:F.value,output_format:J.value,...C.value?{aspect_ratio:C.value}:{}},d=await g.subscribe("fal-ai/flux-pro/kontext/max",{input:I,logs:!0,onQueueUpdate:y=>{y.status==="IN_PROGRESS"&&y.logs&&y.logs.map(k=>k.message).forEach(k=>{c.value.includes(k)||c.value.push(k)})}});d.data&&d.data.images?(A.value=d.data.images,c.value.push("图片生成成功"),j.value.unshift({params:JSON.parse(JSON.stringify(I)),images:JSON.parse(JSON.stringify(d.data.images)),time:new Date().toLocaleString()})):b.value="未获取到图片结果"}catch(e){b.value=(e==null?void 0:e.message)||"请求失败"}finally{h.value=!1}}return(m,e)=>{const I=f("el-input"),d=f("el-form-item"),y=f("el-button"),k=f("el-form"),X=f("el-checkbox"),Y=f("el-upload"),M=f("el-input-number"),p=f("el-option"),T=f("el-select"),Z=f("el-dialog");return s(),i("div",oe,[e[21]||(e[21]=a("h2",null,"fal.ai 图像编辑 DEMO",-1)),a("div",se,[l(k,{inline:!0,class:"apikey-form"},{default:o(()=>[l(d,{label:"API Key："},{default:o(()=>[l(I,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=t=>_.value=t),type:"password",placeholder:"请输入 fal.ai API Key",style:{width:"260px"}},null,8,["modelValue"])]),_:1}),l(d,null,{default:o(()=>[l(y,{type:"primary",onClick:G},{default:o(()=>e[9]||(e[9]=[v("保存")])),_:1}),u.value?(s(),te(y,{key:0,onClick:Q,type:"default"},{default:o(()=>e[10]||(e[10]=[v("清除")])),_:1})):x("",!0)]),_:1})]),_:1}),u.value?(s(),i("div",ie,e[12]||(e[12]=[a("span",{style:{color:"green"}},"API Key 已保存，可正常使用 fal.ai 能力。",-1)]))):(s(),i("div",ue,e[11]||(e[11]=[a("span",{style:{color:"red"}},"请先输入 API Key，所有功能仅用于 DEMO，切勿用于生产环境！",-1)])))]),l(k,{class:"falai-form",onSubmit:le(W,["prevent"]),"label-width":"140px"},{default:o(()=>[l(d,{label:"固定提示词："},{default:o(()=>[e[14]||(e[14]=a("div",{style:{background:"#f5f7fa",padding:"12px","border-radius":"6px",border:"1px solid #e4e7ed","margin-bottom":"8px"}},[a("div",{style:{"font-size":"14px",color:"#606266","line-height":"1.6"}},[v(" 保持瓶子的确切形状、比例和泵头位置不变。"),a("br"),v(" 不要改变瓶子的数量、大小、角度、位置或布局 — 即使图像包含多个不同大小的瓶子。"),a("br"),v(" 瓶子的结构和位置必须保持完全不变。"),a("br"),v(" 任何添加的内容都应该自然地、干净地集成，而不破坏或覆盖原始布局。"),a("br"),v(" 注意：请根据产品信息应用所有视觉更新，同时保持瓶子的完整性。 ")])],-1)),l(X,{modelValue:L.value,"onUpdate:modelValue":e[1]||(e[1]=t=>L.value=t),disabled:!u.value},{default:o(()=>e[13]||(e[13]=[v("使用固定提示词")])),_:1},8,["modelValue","disabled"])]),_:1}),l(d,{label:"描述（Prompt）："},{default:o(()=>[l(I,{modelValue:U.value,"onUpdate:modelValue":e[2]||(e[2]=t=>U.value=t),type:"textarea",autosize:{minRows:4,maxRows:8},disabled:!u.value,placeholder:"请输入描述，如：在面粉旁边放一个甜甜圈。",style:{width:"100%","font-size":"16px"}},null,8,["modelValue","disabled"])]),_:1}),l(d,{label:"图片："},{default:o(()=>[l(Y,{"show-file-list":!0,disabled:!u.value,accept:"image/*",action:"#","auto-upload":!1,"on-change":q,limit:1},{default:o(()=>[l(y,{disabled:!u.value},{default:o(()=>e[15]||(e[15]=[v("选择图片")])),_:1},8,["disabled"])]),_:1},8,["disabled"]),e[16]||(e[16]=a("span",{style:{margin:"0 8px"}},"或",-1)),l(I,{modelValue:O.value,"onUpdate:modelValue":e[3]||(e[3]=t=>O.value=t),disabled:!u.value,placeholder:"图片 URL（可选）",style:{width:"260px"}},null,8,["modelValue","disabled"])]),_:1}),l(d,{label:"引导强度："},{default:o(()=>[l(M,{modelValue:D.value,"onUpdate:modelValue":e[4]||(e[4]=t=>D.value=t),min:1,max:20,step:.1,disabled:!u.value},null,8,["modelValue","disabled"])]),_:1}),l(d,{label:"生成图片数量："},{default:o(()=>[l(M,{modelValue:F.value,"onUpdate:modelValue":e[5]||(e[5]=t=>F.value=t),min:1,max:4,disabled:!u.value},null,8,["modelValue","disabled"])]),_:1}),l(d,{label:"输出格式："},{default:o(()=>[l(T,{modelValue:J.value,"onUpdate:modelValue":e[6]||(e[6]=t=>J.value=t),disabled:!u.value,style:{width:"120px"}},{default:o(()=>[l(p,{label:"JPEG 格式",value:"jpeg"}),l(p,{label:"PNG 格式",value:"png"})]),_:1},8,["modelValue","disabled"])]),_:1}),l(d,{label:"宽高比："},{default:o(()=>[l(T,{modelValue:C.value,"onUpdate:modelValue":e[7]||(e[7]=t=>C.value=t),disabled:!u.value,style:{width:"120px"}},{default:o(()=>[l(p,{label:"默认",value:""}),l(p,{label:"21:9",value:"21:9"}),l(p,{label:"16:9",value:"16:9"}),l(p,{label:"4:3",value:"4:3"}),l(p,{label:"3:2",value:"3:2"}),l(p,{label:"1:1",value:"1:1"}),l(p,{label:"2:3",value:"2:3"}),l(p,{label:"3:4",value:"3:4"}),l(p,{label:"9:16",value:"9:16"}),l(p,{label:"9:21",value:"9:21"})]),_:1},8,["modelValue","disabled"])]),_:1}),l(d,null,{default:o(()=>[l(y,{type:"primary","native-type":"submit",disabled:!u.value||h.value},{default:o(()=>[v(r(h.value?"生成中...":"生成图片"),1)]),_:1},8,["disabled"])]),_:1})]),_:1}),b.value?(s(),i("div",ne,r(b.value),1)):x("",!0),c.value.length?(s(),i("div",de,[e[17]||(e[17]=a("div",{style:{"font-weight":"bold"}},"日志：",-1)),a("ul",null,[(s(!0),i(S,null,E(c.value,(t,V)=>(s(),i("li",{key:V},r(t),1))),128))])])):x("",!0),A.value.length?(s(),i("div",re,[e[18]||(e[18]=a("div",{style:{"font-weight":"bold"}},"生成结果：",-1)),a("div",pe,[(s(!0),i(S,null,E(A.value,(t,V)=>(s(),i("div",{key:V,style:{border:"1px solid #eee",padding:"8px","border-radius":"6px",background:"#fff"}},[a("img",{src:t.url,alt:"result-"+V,width:t.width/4,height:t.height/4,style:{"max-width":"200px",display:"block","margin-bottom":"8px",cursor:"pointer"},onClick:P=>B(t)},null,8,ve),a("div",me,r(t.width)+"x"+r(t.height),1)]))),128))])])):x("",!0),j.value.length?(s(),i("div",fe,[e[20]||(e[20]=a("div",{style:{"font-weight":"bold","font-size":"16px"}},"历史记录",-1)),(s(!0),i(S,null,E(j.value,(t,V)=>(s(),i("div",{key:V,style:{"margin-top":"18px",padding:"12px",border:"1px solid #eee","border-radius":"6px",background:"#f8f8fa"}},[a("div",ce,r(t.time),1),a("div",be,[e[19]||(e[19]=v("Prompt: ")),a("span",ye,r(t.params.prompt),1)]),a("div",ge,[v("引导强度: "+r(t.params.guidance_scale)+" | 数量: "+r(t.params.num_images)+" | 输出格式: "+r(t.params.output_format)+" ",1),t.params.aspect_ratio?(s(),i("span",_e,"| 宽高比: "+r(t.params.aspect_ratio),1)):x("",!0)]),a("div",xe,[(s(!0),i(S,null,E(t.images,(P,$)=>(s(),i("div",{key:$,style:{border:"1px solid #eee",padding:"4px","border-radius":"4px",background:"#fff"}},[a("img",{src:P.url,alt:"history-"+V+"-"+$,width:P.width/8,height:P.height/8,style:{"max-width":"100px",display:"block",cursor:"pointer"},onClick:Ae=>B(P)},null,8,he),a("div",we,r(P.width)+"x"+r(P.height),1)]))),128))])]))),128))])):x("",!0),l(Z,{modelValue:N.value,"onUpdate:modelValue":e[8]||(e[8]=t=>N.value=t),title:"图片预览",width:"80%","before-close":H},{default:o(()=>[a("div",ke,[w.value?(s(),i("img",{key:0,src:w.value.url,style:{"max-width":"100%","max-height":"70vh","object-fit":"contain"}},null,8,Ve)):x("",!0),w.value?(s(),i("div",Pe," 尺寸: "+r(w.value.width)+" x "+r(w.value.height),1)):x("",!0)])]),_:1},8,["modelValue"])])}}}),Ce=(K,g)=>{const _=K.__vccOpts||K;for(const[u,z]of g)_[u]=z;return _},Se=Ce(Ue,[["__scopeId","data-v-f840d5c3"]]);export{Se as default};
