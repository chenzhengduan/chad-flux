const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index2.js","./index.js"])))=>i.map(i=>d[i]);
import{d as J,r as i,o as L,_ as z,c as o,a as s,b as t,e as _,w as y,v as c,f as O,g as j,t as n,h as B,F as k,i as I,j as C}from"./index.js";const G={class:"fal-ai-image-edit"},T={class:"apikey-section"},Q={key:1,class:"tip"},q={key:2,class:"tip"},H={class:"form-row"},W=["disabled"],X={class:"form-row"},Y=["disabled"],Z=["disabled"],$={class:"form-row"},ee=["disabled"],te={class:"form-row"},ae=["disabled"],le={class:"form-row"},oe=["disabled"],se={class:"form-row"},ie=["disabled"],ne={class:"form-row"},ue=["disabled"],de={key:0,style:{color:"red","margin-top":"16px"}},re={key:1,style:{"margin-top":"16px"}},pe={key:2,style:{"margin-top":"24px"}},ve={style:{display:"flex","flex-wrap":"wrap",gap:"16px"}},fe=["src","alt","width","height"],me={style:{"font-size":"12px",color:"#888"}},ge={key:3,style:{"margin-top":"40px"}},ye={style:{"font-size":"13px",color:"#888","margin-bottom":"6px"}},_e={style:{"margin-bottom":"6px"}},ce={style:{color:"#333"}},be={style:{"margin-bottom":"6px"}},xe={key:0},he={style:{display:"flex","flex-wrap":"wrap",gap:"12px"}},we=["src","alt","width","height"],ke={style:{"font-size":"11px",color:"#aaa"}},Ie=J({__name:"falAIImageEdit",setup(S){let r=null;const p=i(""),l=i(null);L(async()=>{const u=localStorage.getItem("fal_apikey");u&&(p.value=u,l.value=u,await b(),l.value&&r.config({credentials:l.value}))});async function b(){r||(r=(await z(async()=>{const{fal:u}=await import("./index2.js").then(e=>e.i);return{fal:u}},__vite__mapDeps([0,1]),import.meta.url)).fal)}function M(){p.value&&(localStorage.setItem("fal_apikey",p.value),l.value=p.value,r&&r.config({credentials:p.value}))}function D(){localStorage.removeItem("fal_apikey"),p.value="",l.value=null}const P=i(""),U=i(""),x=i(null),V=i(3.5),A=i(1),E=i("jpeg"),h=i(""),g=i(!1),f=i([]),m=i(""),w=i([]),N=i([]);function R(u){const e=u.target;e.files&&e.files.length>0?x.value=e.files[0]:x.value=null}async function F(){if(m.value="",f.value=[],w.value=[],g.value=!0,await b(),!r){m.value="fal-ai 客户端加载失败",g.value=!1;return}if(!l.value){m.value="请先输入 API Key",g.value=!1;return}r.config({credentials:l.value});let u=U.value;try{if(x.value&&(f.value.push("正在上传图片..."),u=await r.storage.upload(x.value),f.value.push("图片上传成功")),!u){m.value="请上传图片或填写图片 URL",g.value=!1;return}f.value.push("正在请求 fal.ai 生成图片...");const e={prompt:P.value,image_url:u,guidance_scale:V.value,num_images:A.value,output_format:E.value,...h.value?{aspect_ratio:h.value}:{}},a=await r.subscribe("fal-ai/flux-pro/kontext/max",{input:e,logs:!0,onQueueUpdate:d=>{d.status==="IN_PROGRESS"&&d.logs&&d.logs.map(v=>v.message).forEach(v=>{f.value.includes(v)||f.value.push(v)})}});a.data&&a.data.images?(w.value=a.data.images,f.value.push("图片生成成功"),N.value.unshift({params:JSON.parse(JSON.stringify(e)),images:JSON.parse(JSON.stringify(a.data.images)),time:new Date().toLocaleString()})):m.value="未获取到图片结果"}catch(e){m.value=(e==null?void 0:e.message)||"请求失败"}finally{g.value=!1}}return(u,e)=>(s(),o("div",G,[e[23]||(e[23]=t("h2",null,"fal.ai 图像编辑 DEMO",-1)),t("div",T,[e[9]||(e[9]=t("label",{for:"fal-apikey"},"API Key：",-1)),y(t("input",{id:"fal-apikey","onUpdate:modelValue":e[0]||(e[0]=a=>p.value=a),type:"password",placeholder:"请输入 fal.ai API Key"},null,512),[[c,p.value]]),t("button",{onClick:M},"保存"),l.value?(s(),o("button",{key:0,onClick:D},"清除")):_("",!0),l.value?(s(),o("div",q,e[8]||(e[8]=[t("span",{style:{color:"green"}},"API Key 已保存，可正常使用 fal.ai 能力。",-1)]))):(s(),o("div",Q,e[7]||(e[7]=[t("span",{style:{color:"red"}},"请先输入 API Key，所有功能仅用于 DEMO，切勿用于生产环境！",-1)])))]),t("form",{class:"falai-form",onSubmit:B(F,["prevent"])},[t("div",H,[e[10]||(e[10]=t("label",null,"描述（Prompt）：",-1)),y(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>P.value=a),disabled:!l.value,placeholder:"请输入描述，如：在面粉旁边放一个甜甜圈。"},null,8,W),[[c,P.value]])]),t("div",X,[e[11]||(e[11]=t("label",null,"图片：",-1)),t("input",{type:"file",accept:"image/*",onChange:R,disabled:!l.value},null,40,Y),e[12]||(e[12]=t("span",{style:{margin:"0 8px"}},"或",-1)),y(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>U.value=a),disabled:!l.value,placeholder:"图片 URL（可选）"},null,8,Z),[[c,U.value]])]),t("div",$,[e[13]||(e[13]=t("label",null,"引导强度（guidance_scale）：",-1)),y(t("input",{type:"number",step:"0.1","onUpdate:modelValue":e[3]||(e[3]=a=>V.value=a),disabled:!l.value,min:"1",max:"20"},null,8,ee),[[c,V.value,void 0,{number:!0}]])]),t("div",te,[e[14]||(e[14]=t("label",null,"生成图片数量（num_images）：",-1)),y(t("input",{type:"number","onUpdate:modelValue":e[4]||(e[4]=a=>A.value=a),disabled:!l.value,min:"1",max:"4"},null,8,ae),[[c,A.value,void 0,{number:!0}]])]),t("div",le,[e[16]||(e[16]=t("label",null,"输出格式（output_format）：",-1)),y(t("select",{"onUpdate:modelValue":e[5]||(e[5]=a=>E.value=a),disabled:!l.value},e[15]||(e[15]=[t("option",{value:"jpeg"},"JPEG 格式",-1),t("option",{value:"png"},"PNG 格式",-1)]),8,oe),[[O,E.value]])]),t("div",se,[e[18]||(e[18]=t("label",null,"宽高比（aspect_ratio）：",-1)),y(t("select",{"onUpdate:modelValue":e[6]||(e[6]=a=>h.value=a),disabled:!l.value},e[17]||(e[17]=[j('<option value="" data-v-0e670f71>默认</option><option value="21:9" data-v-0e670f71>21:9</option><option value="16:9" data-v-0e670f71>16:9</option><option value="4:3" data-v-0e670f71>4:3</option><option value="3:2" data-v-0e670f71>3:2</option><option value="1:1" data-v-0e670f71>1:1</option><option value="2:3" data-v-0e670f71>2:3</option><option value="3:4" data-v-0e670f71>3:4</option><option value="9:16" data-v-0e670f71>9:16</option><option value="9:21" data-v-0e670f71>9:21</option>',10)]),8,ie),[[O,h.value]])]),t("div",ne,[t("button",{type:"submit",disabled:!l.value||g.value},n(g.value?"生成中...":"生成图片"),9,ue)])],32),m.value?(s(),o("div",de,n(m.value),1)):_("",!0),f.value.length?(s(),o("div",re,[e[19]||(e[19]=t("div",{style:{"font-weight":"bold"}},"日志：",-1)),t("ul",null,[(s(!0),o(k,null,I(f.value,(a,d)=>(s(),o("li",{key:d},n(a),1))),128))])])):_("",!0),w.value.length?(s(),o("div",pe,[e[20]||(e[20]=t("div",{style:{"font-weight":"bold"}},"生成结果：",-1)),t("div",ve,[(s(!0),o(k,null,I(w.value,(a,d)=>(s(),o("div",{key:d,style:{border:"1px solid #eee",padding:"8px","border-radius":"6px",background:"#fff"}},[t("img",{src:a.url,alt:"result-"+d,width:a.width/4,height:a.height/4,style:{"max-width":"200px",display:"block","margin-bottom":"8px"}},null,8,fe),t("div",me,n(a.width)+"x"+n(a.height),1)]))),128))])])):_("",!0),N.value.length?(s(),o("div",ge,[e[22]||(e[22]=t("div",{style:{"font-weight":"bold","font-size":"16px"}},"历史记录",-1)),(s(!0),o(k,null,I(N.value,(a,d)=>(s(),o("div",{key:d,style:{"margin-top":"18px",padding:"12px",border:"1px solid #eee","border-radius":"6px",background:"#f8f8fa"}},[t("div",ye,n(a.time),1),t("div",_e,[e[21]||(e[21]=C("Prompt: ")),t("span",ce,n(a.params.prompt),1)]),t("div",be,[C("guidance_scale: "+n(a.params.guidance_scale)+" | num_images: "+n(a.params.num_images)+" | output_format: "+n(a.params.output_format)+" ",1),a.params.aspect_ratio?(s(),o("span",xe,"| aspect_ratio: "+n(a.params.aspect_ratio),1)):_("",!0)]),t("div",he,[(s(!0),o(k,null,I(a.images,(v,K)=>(s(),o("div",{key:K,style:{border:"1px solid #eee",padding:"4px","border-radius":"4px",background:"#fff"}},[t("img",{src:v.url,alt:"history-"+d+"-"+K,width:v.width/8,height:v.height/8,style:{"max-width":"100px",display:"block"}},null,8,we),t("div",ke,n(v.width)+"x"+n(v.height),1)]))),128))])]))),128))])):_("",!0)]))}}),Se=(S,r)=>{const p=S.__vccOpts||S;for(const[l,b]of r)p[l]=b;return p},Ue=Se(Ie,[["__scopeId","data-v-0e670f71"]]);export{Ue as default};
